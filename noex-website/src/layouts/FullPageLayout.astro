---
import '../styles/global.css';
import { type Locale, useTranslations, locales, getLocalizedPath } from '../i18n/utils';
import ScrollIndicator from '../components/ui/ScrollIndicator.svelte';
import Navigation from '../components/ui/Navigation.svelte';

interface Props {
  locale: Locale;
  currentPath?: string;
}

const { locale, currentPath = '/' } = Astro.props;
const t = useTranslations(locale);
const scrollIndicatorLabel = locale === 'cs' ? 'Sekce str√°nky' : 'Page sections';

// Navigation translations
const navTranslations = {
  features: t('nav.features'),
  playground: t('nav.playground'),
  github: t('nav.github'),
  hero: t('nav.hero'),
  problem: t('nav.problem'),
  services: t('nav.services'),
  observability: t('nav.observability'),
  distribution: t('nav.distribution'),
  cta: t('nav.cta'),
  openMenu: t('nav.openMenu'),
  closeMenu: t('nav.closeMenu'),
};

const langSwitcherTranslations = {
  label: t('languageSwitcher.label'),
  currentLang: t('languageSwitcher.currentLang'),
};
---

<!DOCTYPE html>
<html lang={locale}>
  <head>
    <meta charset="utf-8" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content={t('meta.description')} />
    <title>{t('meta.title')}</title>

    <!-- Alternate language links for SEO -->
    {locales.map((l) => (
      <link
        rel="alternate"
        hreflang={l}
        href={getLocalizedPath(currentPath, l)}
      />
    ))}

    <!-- Preload fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap"
      rel="stylesheet"
    />
  </head>
  <body class="snap-container">
    <!-- Navigation -->
    <Navigation
      {locale}
      {currentPath}
      translations={navTranslations}
      langSwitcherTranslations={langSwitcherTranslations}
      client:load
    />

    <!-- Main Content with Scroll Snap -->
    <main>
      <slot />
    </main>

    <!-- Scroll Indicator with keyboard navigation -->
    <ScrollIndicator client:only="svelte" ariaLabel={scrollIndicatorLabel} />
  </body>
</html>
